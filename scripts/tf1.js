// @type: replacement
// @from https://static.mytf1.tf1.fr/assets/js/build/blocks/sections/content-video-2-html5.js?bust=216
define(["lib/hammer","blocks/sections/abtasty-reco","blocks/sections/abtasty-pub"],function(e,t,i){function o(){p.classList.contains("initialized")||(this.hasSend=[],T=p.getAttribute("data-protected"),this.checkDevice(),this.eventResize(),this.init(),this.userConnected=!1,"oui"===window.xtcustom.c_connexion?this.checkUserLog(null,!0):class_gigya.getAccountInfo(function(e){this.checkUserLog(e)}.bind(this)))}function n(e){return function(e,t,i){}}function a(e){var t=e.lastChild,i=document.createElement("div");return e.insertBefore(i,t),i.setAttribute("class",t.getAttribute("class")),i.setAttribute("data-href",t.getAttribute("href")),i.innerHTML=t.innerHTML,e.removeChild(t),i}function r(e,t,i){var o=0;return function(){var n;for(n=o;n<Math.min(o+i,t.length);n++)e(t[n],n);var a=o&&o<t.length;return o=n,a}}"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),document.MYTF1=document.MYTF1||{},document.MYTF1.recoVideoFrom=document.MYTF1.recoVideoFrom||{};var s,d=document.body,c=(document.getElementById("TF1__header"),document.getElementById("program_nav")),l=document.getElementById("player_video"),u=(l.getElementsByClassName("sliderBox")[0],l.getElementsByClassName("frame")[0]),m=[].slice.call(l.getElementsByClassName("item")),g=l.getElementsByClassName("active")[0]||!1,p=document.getElementsByClassName("player_video")[0],v=document.getElementById("zonePlayer"),y=!1,f=(l.getElementsByClassName("arrow_left")[0],l.getElementsByClassName("arrow_right")[0],l.getElementsByClassName("close")[0]),h=[].slice.call(l.getElementsByClassName("navigatePlayer")),_=!1,b=!1,E=function(){},C=function(){},w=!1,S=function(){},A=function(){},I=function(){},k=!1,T=!1,M=!1,P=!1,L=function(e,t,i){},x=function(e,t,i){},N=function(e,t,i){},B=!1,F="web",V=void 0;o.prototype.checkUserLog=function(e,t){(!0===t||e&&e.profile)&&(this.userConnected=!0),this.initABTastyCookie(e&&e.profile),this.initPlayer(),this.addVosProgramXitiHits()},o.prototype.addVosProgramXitiHits=function(){var e=document.querySelectorAll(".program.key-list-programs-une");e&&e.length>0&&[].forEach.call(e,function(e,t){e.addEventListener("click",function(e){if(e.currentTarget&&e.currentTarget.firstChild&&e.currentTarget.firstChild.href){var i=e.currentTarget.firstChild.href,o=i.split("/");if(o.length>1){var n={secure:"https:"===document.location.protocol,site:"production"===reqConfig.envConfig.ENV?553584:553907},a=sessionStorage.getItem("idclient")||!1,r=!1;a&&(n.ClientSideUserId={clientSideMode:"always"},r={userIdentifier:a});var s=o[o.length-1]+"_"+o[o.length-2],d="oui"===window.xtcustom.c_connexion||"1"===window.xtcustom.c_connexion||1===window.xtcustom.c_connexion,c=new ATInternet.Tracker.Tag(n,r);c.page.send({name:t+1+"",chapter1:"vos-programmes::"+s,level2:104,customObject:{s_device:window.xtcustom.s_device,s_orientation:window.xtcustom.s_orientation,s_os:window.xtcustom.s_os,p_typepage:window.xtcustom.p_typepage,c_connexion:d?1:0}}),c.dispatch()}}})});var t=document.querySelector("a.title_link_name");t&&t.addEventListener("click",function(e){var t={secure:"https:"===document.location.protocol,site:"production"===reqConfig.envConfig.ENV?553584:553907},i=sessionStorage.getItem("idclient")||!1,o=!1;i&&(t.ClientSideUserId={clientSideMode:"always"},o={userIdentifier:i}),window.xtpage.split("::").pop();var n="oui"===window.xtcustom.c_connexion||"1"===window.xtcustom.c_connexion||1===window.xtcustom.c_connexion,a=new ATInternet.Tracker.Tag(t,o);a.page.send({name:"plus-de-programmes",chapter1:"vos-programmes::null",level2:104,customObject:{s_device:window.xtcustom.s_device,s_orientation:window.xtcustom.s_orientation,s_os:window.xtcustom.s_os,p_typepage:window.xtcustom.p_typepage,c_connexion:n?1:0}}),a.dispatch()})},o.prototype.fillCoreg=function(e){require(["lib/coreg"],function(t){new t(e,this.initPlayer)}.bind(this))},o.prototype.adBlockActivated=void 0,o.prototype.adblockIsActivated=function(e){if(void 0!==this.adBlockActivated)return void e(this.adBlockActivated);var t=document.createElement("div");t.innerHTML="&nbsp;",t.className="ads ad adsbox ad-placement carbon-ads",window.document.body.appendChild(t),setTimeout(function(){0===t.offsetHeight?this.adBlockActivated=document.querySelector(".needAdBlockDisabled"):this.adBlockActivated=!1,t.remove(),e(this.adBlockActivated)}.bind(this),100)};var q;return o.prototype.logEventPlayer=function(e){switch(e){case"onReady":var t=window.document.MYTF1&&window.document.MYTF1.recoVideoFrom&&"poursuite-lecture-auto"===window.document.MYTF1.recoVideoFrom.c_reco_action?"auto":"manuel";__TMS.setAttribute("content_video_playAlong",t),q=e;break;case"onSeeked":__TMS.setAttribute("content_video_action","seek"),q=e,window.__TMS.triggerPage();break;case"onAdPause":"pause"!==q&&(__TMS.setAttribute("content_video_action","pause"),q="pause",window.__TMS.triggerPage());break;case"onMediaPause":case"onUserPause":__TMS.setAttribute("content_video_action","pause"),q="pause",window.__TMS.triggerPage();break;default:q=e}},o.prototype.initPlayer=function(){var e=document.querySelector(".needSubscribe")||!1,t=document.querySelector(".needAdBlockDisabled")||!1;this.adblockIsActivated(function(i){if(false)i.style.display="block";else if(t&&e.parentNode&&t.parentNode.removeChild(t),this.userConnected||0==T){e&&(e.parentNode.removeChild(e),e=!1);var o=v.getAttribute("data-playlist");s=document.querySelector(".playerVideo").getAttribute("new-player")||!1,s&&1!==o?require(["blocks/sections/new-player"],function(e){w=new e,w.addEventListener("saveDMP",L),w.addEventListener("onSlotStop",x),w.addEventListener("onSlotStart",N),w.addEventListener("onReady",this.logEventPlayer.bind(this,"onReady")),w.addEventListener("onStart",n("onStart")),w.addEventListener("onAdPlay",this.logEventPlayer.bind(this,"onAdPlay")),w.addEventListener("onAdPause",this.logEventPlayer.bind(this,"onAdPause")),w.addEventListener("onAdStop",n("onAdStop")),w.addEventListener("onAdPrerollStop",n("onAdPrerollStop")),w.addEventListener("onAdMidrollStop",n("onAdMidrollStop")),w.addEventListener("onMediaPlay",n("onMediaPlay")),w.addEventListener("onMediaPause",this.logEventPlayer.bind(this,"onMediaPause")),w.addEventListener("onMediaStop",n("onMediaStop")),w.addEventListener("onUserPlay",n("onUserPlay")),w.addEventListener("onUserPause",this.logEventPlayer.bind(this,"onUserPause")),w.addEventListener("onSeeked",this.logEventPlayer.bind(this,"onSeeked")),w.addEventListener("clearCompanion",n("clearCompanion")),w.addEventListener("onEnterFullscreen",n("onEnterFullscreen")),w.addEventListener("onExitFullscreen",n("onExitFullscreen")),w.addEventListener("onMediaTitleChange",n("onMediaTitleChange")),w.addEventListener("saveDMP",n("saveDMP")),document._currentOPlayer={pause:function(){w.setPause()}}}.bind(this)):require(["blocks/sections/playerhtml5"],function(e){w=new e(v,!1,!1,!1,"MYTF1")}.bind(this)),document.getElementsByClassName("playerVideo")[0].addEventListener("miniVideoClick",function(){var e=v.getAttribute("data-url");document.body.classList.contains("skin_video")||""===e||class_page.ajaxLoad(e)})}}.bind(this))},o.prototype.changeElements=function(e,t){if(e){var i=e.getElementsByTagName("img")[0];if(t<10){if(t+=1,!(void 0!==i&&parseInt(i.offsetHeight)>0))return setTimeout(function(){this.changeElements(e,t)}.bind(this),500);var o=parseInt(i.offsetHeight);if(o>0){var n=document.getElementsByClassName("metaHeader")[0],a=document.getElementById("TF1__header"),r=e.parentNode.parentNode.parentNode,s=document.getElementById("program_nav"),d=document.getElementById("wrapper"),c=document.getElementsByClassName("container")[0],l=parseFloat(c.offsetTop)+o,u=c.offsetHeight+l;d.insertBefore(r,n),r.style.position="fixed",r.style.width="100%",r.style.top="0",r.style.backgroundColor="#2f323c",a.style.position="fixed",a.style.width="100%",a.style.top=o+"px",c.style.top=l+"px",s.style.marginTop=u+"px",s.setAttribute("data-top",1)}}}},o.prototype.changeMobilePubPosition=function(){var e=document.getElementById("ban_mobile");"undefined"!==e&&window.innerWidth<768&&this.changeElements(e,0)},o.prototype.init=function(){if(this.changeMobilePubPosition(),window.addEventListener("resize",Cowboy.throttle(200,this.eventResize.bind(this))),this.initDescription(),this.eventResize(),"mobile"!==F&&this.addMiniPlayerEvents(),p.classList.add("initialized"),(B=c.querySelector(".btn_follow")||!1)&&class_gigya){var e=class_gigya.getListPrograms();if(e&&e[B.getAttribute("data-id")]){var t=B.getElementsByClassName("js_label")[0];B.getAttribute("data-id");B.classList.remove("loading"),B.classList.add("on"),t.innerHTML=B.getAttribute("data-text-on")}}if(B&&B.addEventListener("click",function(e){e.preventDefault(),class_gigya.getAccountInfo(function(e){this.checkUserLogFollow(e)}.bind(this))}.bind(this)),(P=p.querySelector(".btn_favorite")||!1)&&class_gigya){var i=class_gigya.getListFavoris();if(i&&i[P.getAttribute("data-id")]){var t=P.getElementsByClassName("js_label")[0];P.getAttribute("data-id"),P.getAttribute("data-type");utils.removeClass(P,"loading"),P.classList.add("on"),t.innerHTML=P.getAttribute("data-text-on"),t.previousSibling.setAttribute("data-xiti-libelle","Icone"+P.getAttribute("data-text-on"))}}P&&P.addEventListener("click",function(e){e.preventDefault(),class_gigya.getAccountInfo(function(e){this.checkUserLogFav(P,e)}.bind(this))}.bind(this))},o.prototype.checkDevice=function(){var e={};class_userlib&&(e=class_userlib.getDevice()),"mobile"===e.type?F="mobile":"tablet"===e.type&&(F="tablette")},o.prototype.initDescription=function(){var e=p.getElementsByClassName("description")[0],t=e.getElementsByClassName("arrow")[0];if(e){var i=e.getElementsByTagName("p")[0],o=i?i.offsetHeight:0,n=45;document.body.offsetWidth<1025&&(n=50),o>n&&(utils.removeClass(t,"hide"),t.addEventListener("click",function(){e.style.overflow="auto",utils.addClass(t,"hide")}))}},o.prototype.handleElementClick=function(e){!0!==document.MYTF1.clickNext&&(document.MYTF1.recoVideoFrom.c_reco_action=""),document.MYTF1.clickNext=!1;for(var t in e)e.hasOwnProperty(t)&&(document.MYTF1.recoVideoFrom[t]=e[t]);var i=void 0!==window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0;return document.MYTF1.recoVideoFrom.c_reco_visibilite=i>1?"oui":"non",sessionStorage.setItem("fromRecoObject",JSON.stringify(document.MYTF1.recoVideoFrom)),!0},o.prototype.handleRecoClickForDmp=function(e){var t=[],i=document.getElementById("reco-video-content");if(i){for(var n=i.querySelectorAll("a"),a=0;a<Math.min(10,n.length);a++)t.push(n[a].getAttribute("data-more"));document.MYTF1.recoVideoFrom.c_reco_compoliste=t,e&&Array.prototype.map.call(n,function(e,t){var i=e.getAttribute("data-more"),a={href:e.href,i:t+1,recoLength:n.length+1,Id:i};e.addEventListener("click",o.prototype.handleElementClick.bind(o,a))}.bind(this))}},o.prototype.initABTastyCookie=function(e){var i=sessionStorage.getItem("fromRecoObject");if(i){sessionStorage.setItem("fromRecoObject","");var n=JSON.parse(i);n.c_idvideo=_datapythagore.c_idvideo,n.c_programme_nom=_datapythagore.c_programme_nom,Object.assign(document.MYTF1.recoVideoFrom,n),this.sendDMPReco(n)}if(i&&"poursuite-lecture-auto"!==JSON.parse(i).c_reco_action){var s=!1,d={secure:"https:"===document.location.protocol,site:"production"===reqConfig.envConfig.ENV?553584:553907};if(sessionStorage){var c=sessionStorage.getItem("xtsite")||!1;c&&(d.site=c)}var l=sessionStorage.getItem("idclient")||!1;if(l&&(d.ClientSideUserId={clientSideMode:"always"},s={userIdentifier:l}),"undefined"!=typeof ATInternet&&ATInternet.Tracker){var u="";i&&(u="::"+Number(JSON.parse(i).i));var m,g,p=new ATInternet.Tracker.Tag(d,s),v=xtpage.split("::");v.length>0&&(m=v[0]),v.length>2&&(g=v[2]),p.page.send({name:m+"_"+g+u,chapter1:"bloc-suggestion",level2:xtn2,customObject:{s_device:xtcustom.s_device,s_orientation:xtcustom.s_orientation,s_os:xtcustom.s_os,p_typepage:xtcustom.p_typepage,c_connexion:xtcustom.c_connexion}}),p.dispatch()}}if(i&&"poursuite-lecture-auto"===JSON.parse(i).c_reco_action&&(null===sessionStorage.getItem("isContextPoursuite")?sessionStorage.setItem("isContextPoursuite","oui"):sessionStorage.removeItem("isContextPoursuite")),this.userConnected){var y=new t,f=!0;y.getRecos(_datapythagore.c_idvideo,function(e,t){if(document.MYTF1.recoVideoFrom.recoEngineConfig=t,t&&t.recoEngine&&(document.MYTF1.c_reco_moteur_attendu=t.expectedRecoEngine||"",document.MYTF1.c_reco_moteur_applique=t.recoEngine||""),e){var i=document.getElementById("parent-reco-video-content"),n=document.getElementById("reco-video-content"),s=a(i),d=n.firstChild;f=!1;var c;d.clientHeight&&(c=d.clientHeight);var l=n.cloneNode(!1),u=function(t,i){d&&(t.style.height=c+"px");var n={href:t.href,i:i+1,Id:t.getAttribute("data-more"),recoLength:e.length+1};return t.addEventListener("click",o.prototype.handleElementClick.bind(o,n)),l.appendChild(t)},m=r(u,e,16);m(),s.addEventListener("click",function(e){document.MYTF1.recoVideoFrom.c_reco_plusdevideo="oui",m()||(window.location.href=s.getAttribute("data-href"))}.bind(this)),i.removeChild(n),i.insertBefore(l,s)}this.handleRecoClickForDmp(f)}.bind(this))}else document.MYTF1.recoVideoFrom.recoEngineConfig={ID:0,Rules:"",Type:"",expectedRecoEngine:"",recoEngine:"",userId:""},document.MYTF1.c_reco_moteur_attendu="",document.MYTF1.c_reco_moteur_applique="",this.handleRecoClickForDmp(!0)},o.prototype.eventResize=function(){if(!document.body.classList.contains("mini-player")){this.initSlider(!0);var e=document.querySelector(".left"),t=document.querySelector(".right"),i=e.querySelectorAll("div.module:not(.content-video)"),o=t.querySelectorAll("div.module:not(.reco-videos-player)"),n=document.getElementById("bgPlayer"),a=n?n.parentNode:null,r=p.querySelector("#program_nav"),s=window.parent.document.getElementById("global_wrapper");if(window.innerWidth>=1024)v.style.height=Math.round(372.375)+"px",r.style.marginTop=0,o.length&&Array.prototype.forEach.call(o,function(t){e.appendChild(t)}),s.classList.contains("habPub")&&(n.src=n.getAttribute("data-desktop"),a.setAttribute("href",n.getAttribute("data-url-desktop")));else{s.classList.contains("habPub")&&(window.innerWidth>=768&&window.innerWidth<1024?(n.src=n.getAttribute("data-tablet"),a.setAttribute("href",n.getAttribute("data-url-tablet"))):(n.src=n.getAttribute("data-mobile"),a.setAttribute("href",n.getAttribute("data-url-mobile"))));var d=Math.round(window.innerWidth/16*9)+"px";v.style.height=d,r.getAttribute("data-top")||(r.style.marginTop=d),i.length&&Array.prototype.forEach.call(i,function(e){t.appendChild(e)})}}},o.prototype.centerPlayer=function(){var e=(document.body.clientWidth,0);m=[].slice.call(l.getElementsByClassName("item")),m.forEach(function(t){var i=window.getComputedStyle(t);e+=parseInt(t.offsetWidth,10)+parseInt(i.marginLeft,10)+parseInt(i.marginRight,10)})},o.prototype.initSlider=function(e){e&&u.classList.remove("addEffectFrame"),this.centerPlayer(),window.clearTimeout(b),b=window.setTimeout(function(){u.classList.add("addEffectFrame")},100);var t=function(e){if(this.recoVideoPlayStarted){this.recoVideoPlayStarted=!1,e=e||this.currentVideoPlayTime;var t=(v.getAttribute("data-em"),v.getAttribute("data-format"),v.getAttribute("data-duration"));if(t>0){var i=document.MYTF1.recoVideoFrom;if(i&&i.recoEngineConfig&&i.recoEngineConfig.userId){if("cgk"===(i.recoEngineConfig.recoEngine||"")||document.___allowRecoStartStop){var o=i.recoEngineConfig.userId,n={durationViewed:e,percentageViewed:e/t*100,recoID:i.recoEngineConfig.ID,videoID:i.c_idvideo};utils.ajax(reqConfig.envConfig.middleRecoBaseUrl+"action/skip/"+o,{method:"POST",data:n,withCredentials:!0,success:function(e){}.bind(this),error:function(){}})}}}}}.bind(this);V&&(window.removeEventListener("beforeunload",V),V=void 0),V=window.addEventListener("beforeunload",t),I=function(e){if(!this.recoVideoPlayStarted){var t=document.MYTF1.recoVideoFrom;if(t&&t.recoEngineConfig&&t.recoEngineConfig.userId){if("cgk"===(t.recoEngineConfig.recoEngine||"")||document.___allowRecoStartStop){var i=t.recoEngineConfig.userId,o={durationViewed:0,percentageViewed:0,recoID:t.recoEngineConfig.ID,videoID:t.c_idvideo};this.recoVideoPlayStarted=!0,utils.ajax(reqConfig.envConfig.middleRecoBaseUrl+"action/start/"+i,{method:"POST",data:o,withCredentials:!0,success:function(e){}.bind(this),error:function(){}})}}}}.bind(this),S=function(e){var i=(v.getAttribute("data-id"),v.getAttribute("data-em")),o=v.getAttribute("data-format"),n=v.getAttribute("data-duration");this.recoVideoPlayStarted&&t(n),this.sendDMP(100,n,o,i),this.autoNext()}.bind(this),A=function(e){var t=e.detail.time,i=v.getAttribute("data-id"),o=v.getAttribute("data-em"),n=v.getAttribute("data-format"),a=v.getAttribute("data-duration");this.currentVideoPlayTime=t,this.saveCurrentTimeVideo(i,t,o,a,n)}.bind(this),N=function(e,t,i){w.isPlayingPub=!0},x=function(e,t,i){w.isPlayingPub=!1},L=function(e,t,i){var o=i;window.__TMS.setVideoReachedDuration(o);var n=(v.getAttribute("data-id"),v.getAttribute("data-em")),a=v.getAttribute("data-format"),r=v.getAttribute("data-duration");this.currentVideoPlayTime=o;var s=parseInt(o,10)/parseInt(r,10)*100;s>=97&&this.storeVideoId(_datapythagore.c_idvideo),s>=90&&this.sendDMP(90,r,a,n),s>=75&&this.sendDMP(75,r,a,n),s>=50&&this.sendDMP(50,r,a,n),s>=25&&this.sendDMP(25,r,a,n),s>=0&&this.sendDMP(0,r,a,n)}.bind(this),document.getElementsByClassName("playerVideo")[0].addEventListener("onVideoEnded",S),document.getElementsByClassName("playerVideo")[0].addEventListener("onMediaStop",S),document.getElementsByClassName("playerVideo")[0].addEventListener("onMediaPlay",I),document.getElementsByClassName("playerVideo")[0].addEventListener("clearCompanion",function(){var e=document.getElementById("player_video")||document.getElementById("contentPlayer"),t=document.body;if(document.getElementById("player_video")){var i=document.getElementById("global_wrapper"),o=document.getElementById("bgPlayer");if(i.classList.contains("display")){o.setAttribute("data-desktop",o.getAttribute("data-desktop-display")),o.setAttribute("data-tablet",o.getAttribute("data-tablet-display")),o.setAttribute("data-mobile",o.getAttribute("data-mobile-display")),o.setAttribute("data-url-desktop",o.getAttribute("data-url-desktop-display")),o.setAttribute("data-url-tablet",o.getAttribute("data-url-tablet-display")),o.setAttribute("data-url-mobile",o.getAttribute("data-url-mobile-display")),o.setAttribute("data-color",o.getAttribute("data-color"));var n=o.getAttribute("data-desktop"),a=o.getAttribute("data-url-desktop");window.parent.innerWidth<1024&&window.parent.innerWidth>767&&options[3].split("==")[1]?(n=o.getAttribute("data-tablet"),a=o.getAttribute("data-url-tablet")):window.parent.innerWidth<768&&options[4].split("==")[1]&&(n=o.getAttribute("data-mobile"),a=o.getAttribute("data-url-mobile")),o.src=n,o.parentNode.href=a}else o.removeAttribute("src"),o.parentNode.removeAttribute("href"),document.getElementsByClassName("columnsContainer")[0].classList.remove("pubMargin"),document.getElementById("global_wrapper").removeAttribute("class")}else{for(var r=e.parentNode.querySelectorAll(".channel"),s=0,d=r.length;s<d;s++){var c=r[s];utils.hasClass(c,"tmc-grey")&&(utils.addClass(c,"tmc-white"),utils.removeClass(c,"tmc-grey"),utils.removeClass(c,"tmc_grey")),utils.hasClass(c,"tfx-grey")&&(utils.addClass(c,"tfx-white"),utils.removeClass(c,"tfx-grey")),utils.hasClass(c,"tf1-series-films-grey")&&(utils.addClass(c,"tf1-series-films-white"),utils.removeClass(c,"tf1-series-films-grey")),utils.hasClass(c,"tf1-grey")&&(utils.addClass(c,"tf1-white"),utils.removeClass(c,"tf1-grey")),utils.hasClass(c,"lci-grey")&&(utils.addClass(c,"lci-white"),utils.removeClass(c,"lci-grey"))}e.style.background="",t.style.background="";var l=document.getElementById("live")||document.getElementById("content_video");utils.removeClass(l,"customBackground"),utils.removeElement(document.getElementById("pub_video"));for(var u=document.querySelectorAll(".list_videos"),m=0;m<2;m++)if(u[m]){u[m].style.backgroundColor="";for(var g=u[m].querySelectorAll("strong"),p=0,v=g.length;p<v;p++)g[p].style.color=""}for(var y=document.querySelectorAll(".gradient_top"),f=document.querySelectorAll(".gradient_bottom"),h=document.querySelectorAll(".overlay"),_=document.querySelectorAll(".videoPursuit"),b=0,E=y.length;b<E;b++)y[b].style.display="block";for(var C=0,w=f.length;C<w;C++)f[C].style.display="block";for(var S=0,A=h.length;S<A;S++)h[S].style.opacity="";for(var I=0,k=_.length;I<k;I++)_[I].style.opacity="";var T=e.querySelectorAll(".content")[0];T.style.visibility="visible",T.style.display="";window.parent.document.querySelector(".item.active").style.cursor="initial";var M=window.parent.document.getElementById("absoluteLink")||!1;M&&M.parentNode.removeChild(M)}}),document.getElementsByClassName("playerVideo")[0].addEventListener("saveDMP",L),document.getElementsByClassName("playerVideo")[0].addEventListener("onSlotStart",N),document.getElementsByClassName("playerVideo")[0].addEventListener("onSlotStop",x),document.getElementsByClassName("playerVideo")[0].addEventListener("currentPlayHeadTime",A)},o.prototype.saveCurrentTimeVideo=function(e,t,i,o,n){return},o.prototype.clickNext=function(){var e=document.getElementById("reco-video-content");if(_&&setTimeout(function(){window.scrollTo(0,0)},0),e){var t=e.firstChild;t.href+=t.href.indexOf("?")>-1?"":window.location.search,t&&(document.MYTF1.recoVideoFrom.c_reco_action="poursuite-lecture-auto",document.MYTF1.clickNext=!0,sessionStorage.setItem("fromRecoObject",JSON.stringify(document.MYTF1.recoVideoFrom)),localStorage.setItem("isPoursuite",1),t.click())}},o.prototype.autoNext=function(){var e=document.getElementById("content_video");e&&e.getAttribute("data-is-playlist")||(_=!0,this.clickNext())},o.prototype.addNavigateEvents=function(){h.forEach(function(e){e.addEventListener("click",function(t){if(t.preventDefault(),t.stopImmediatePropagation(),utils.hasClass(p,"customBackground")&&!_)return void(_=!1);var i=e.parentNode,o=utils.hasClass(i,"next")||!1,n=e.getAttribute("href"),a=utils.parseUri(n),r=a.relative;M||(M=!0,utils.ajax("/getVideo"+r,{method:"GET",success:function(e){if(M=!1,e){if("flash"==e.typePlayer)return void(window.location=n);if(e.video){if(i.innerHTML=e.video,utils.removeClass(i,"next"),utils.removeClass(i,"previous"),utils.addClass(i,"slide active"),y=g,g=i,o){if(sessionStorage.getItem("reco-overload")){var t=JSON.parse(sessionStorage.getItem("reco-overload"));t.position-=1,sessionStorage.setItem("reco-overload",JSON.stringify(t))}this.changeNext(e)}else{if(sessionStorage.getItem("reco-overload")){var t=JSON.parse(sessionStorage.getItem("reco-overload"));t.position+=1,sessionStorage.setItem("reco-overload",JSON.stringify(t))}this.changePrev(e)}return m=[].slice.call(l.getElementsByClassName("item")),h=[].slice.call(l.getElementsByClassName("navigatePlayer")),void this.addSlideVideo(e,n)}}window.location=n}.bind(this),error:function(){window.location=n}}))}.bind(this))}.bind(this))},o.prototype.checkUserLogFollow=function(e){function t(e){0==e.errorCode&&(delete n[i],sessionStorage.setItem("listPrograms",JSON.stringify(n)),B.classList.remove("on"),o.innerHTML=B.getAttribute("data-text-off"))}function t(e){0==e.errorCode&&(n[i]=e.oid,sessionStorage.setItem("listPrograms",JSON.stringify(n)),B.classList.remove("loading"),B.classList.add("on"),o.innerHTML=B.getAttribute("data-text-on"),o.previousSibling.setAttribute("data-xiti-libelle","Icone"+B.getAttribute("data-text-on")))}var i=B.getAttribute("data-id"),o=B.getElementsByClassName("js_label")[0],n=class_gigya.getListPrograms();if(e&&e.profile)if(B.classList.contains("on")){var a={type:"favoritesPrograms",oid:n[i],callback:t};gigya.ds.delete(a)}else{var a={data:{product:"mytf1",programId:i},type:"favoritesPrograms",oid:"auto",callback:t};gigya.ds.store(a)}else class_gigya.viewConnectPopin()},o.prototype.checkUserLogFav=function(e,t){function i(e){0==e.errorCode&&(delete a[o],sessionStorage.setItem("listFavoris",JSON.stringify(a)),P.classList.remove("on"),n.innerHTML=P.getAttribute("data-text-off"),n.previousSibling.setAttribute("data-xiti-libelle","Icone"+P.getAttribute("data-text-off")))}function i(e){0==e.errorCode&&(a[o]=e.oid,sessionStorage.setItem("listFavoris",JSON.stringify(a)),P.classList.remove("loading"),P.classList.add("on"),n.innerHTML=P.getAttribute("data-text-on"),n.previousSibling.setAttribute("data-xiti-libelle","Icone"+P.getAttribute("data-text-on")))}var o=P.getAttribute("data-id"),n=P.getElementsByClassName("js_label")[0],a=(P.getAttribute("data-type"),class_gigya.getListFavoris());if(t&&t.profile)if(P.classList.contains("on")){var r={type:"favoritesVideos",oid:a[o],callback:i};gigya.ds.delete(r)}else{var r={data:{product:"mytf1",createdAt:(new Date).toISOString(),videoId:o,active:!0},type:"favoritesVideos",oid:"auto",callback:i};gigya.ds.store(r)}else class_gigya.viewConnectPopin()},o.prototype.addEventScroll=function(){E=function(){this.eventScroll()}.bind(this),window.addEventListener("scroll",E),this.eventScroll()},o.prototype.eventScroll=function(){if(!(utils.hasClass(d,"mini-player")&&utils.hasClass(d,"hasMiniNotVideo")||document.querySelector(".needSubscribe")||document.querySelector(".needAdBlockDisabled")&&"none"!==document.querySelector(".needAdBlockDisabled").style.display)){var e=.1*v.offsetHeight,t=document.getElementsByClassName("section center columnsContainer"),i=t&&t.length>0?parseInt(window.getComputedStyle(t[0]).marginTop):20,o=utils.scrollY();if(w.isPlayingPub&&(o>e+i&&w?(this.logEventPlayer("onAdPause",w),w.setPause()):w.setPlay()),document.body.offsetWidth<768)return void this.desactivateMini();o>e?this.activateMini():this.desactivateMini()}},o.prototype.addSlideVideo=function(e,t){var i=v.getAttribute("data-playlist");if(e){if(this.initSlider(!0),w&&w.removeEvents(),e.seo&&e.seo.title&&(document.title=e.seo.title),e.infosContent.watId&&(_datapythagore.c_idwat=e.infosContent.watId),e.infosContent.moveId&&(_datapythagore.c_idmove=e.infosContent.moveId),e.infosContent.refId&&(_datapythagore.c_idvideo=e.infosContent.refId),p.setAttribute("data-protected",0),T=parseInt(e.isProtected,10),e.ads){switch(F){case"web":oas_conf.web.site_page=e.ads.desktop.data.id||oas_tag.site_page;break;case"mobile":oas_conf.mobile.site_page=e.ads.smartphone.data.id||oas_tag.site_page;break;case"tablette":oas_conf.tablette.site_page=e.ads.tablette.data.id||oas_tag.site_page;break;default:return}oas_script&&oas_script.reloadAds()}if(e.xiti){wrapper.insertAdjacentHTML("afterbegin",e.xiti);try{xtDynamicHit()}catch(e){}}try{history.pushState&&history.pushState({},e.seo.title,t)}catch(e){}e.videoCover&&(l.style.backgroundImage="url('"+e.videoCover+"')");var o=wrapper.getElementsByTagName("style")[0];o&&wrapper.removeChild(o),e.customCSS&&wrapper.insertAdjacentHTML("afterbegin",e.customCSS);[].slice.call(document.getElementsByClassName("list_videos")).forEach(function(e,t){e.parentNode.removeChild(e)}),e.reco2&&wrapper.insertAdjacentHTML("afterbegin",e.reco2),e.reco1&&wrapper.insertAdjacentHTML("afterbegin",e.reco1),e.recoSpe&&wrapper.insertAdjacentHTML("afterbegin",e.recoSpe);var n=wrapper.querySelectorAll(".list_videos");for(var a in n){var r=n[a];"object"==typeof r&&(class_page.addJavascriptLinkRedirect(r),class_page.addJavascriptBlocks(r),class_page.addLinksEvents(r),class_page.parseDate(r))}if(class_page&&class_page.reevaluateImg(),utils.parseScript(e.xiti),v=document.getElementById("zonePlayer")){var d=document.querySelector(".needSubscribe")||!1,c=function(e){d&&d.parentNode&&d.parentNode.removeChild(d),this.autoRedirect=_,s&&1!==i?require(["blocks/sections/new-player"],function(e){w=new e,w.isPlayingPub=!1}.bind(this)):require(["blocks/sections/playerhtml5"],function(e){w=new e(v,!1,!1,!1,"MYTF1"),w.isPlayingPub=!1}.bind(this))}.bind(this);if(0==T)return void c();class_gigya.parseConnectButtons(d),gigya&&gigya.accounts&&(gigya.accounts.addEventHandlers({onLogin:function(e){c(e)}.bind(this),onLogout:function(e){window.location.reload()}}),class_gigya.getAccountInfo(function(e){e&&e.profile&&c(e)}.bind(this)))}else window.location=t;xiti_script&&(_&&xiti_script.addXTCustom("v_contexte","poursuite"),xiti_script.applyLog()),_=!1,this.addNavigateEvents(),p=document.getElementsByClassName("player_video")[0]}},o.prototype.changeNext=function(e){var t=JSON.parse(sessionStorage.getItem("reco-overload"))||null;if(document.body.removeEventListener("onVideoEnded",S),document.body.removeEventListener("onMediaStop",S),document.body.removeEventListener("onMediaPlay",I),utils.removeClass(y,"slide active"),utils.addClass(y,"previous"),utils.hasClass(g,"overload")||(y.innerHTML=e.videoPrevious),e.videoNext){var i=document.createElement("div");utils.hasClass(g,"overload")?(i.className="item next fake",u.appendChild(i)):(i.className="item next",i.innerHTML=e.videoNext,u.insertBefore(i,g.nextSibling))}else{var o=document.createElement("div");o.className="item next fake",u.appendChild(o)}t&&1===t.position&&this.insertOverload(t.next);var o=document.createElement("div");o.className="item next fake",u.appendChild(o),utils.hasClass(g,"overload")&&(y.removeChild(y.getElementsByClassName("container")[0]),y.removeChild(y.getElementsByClassName("block_socialshare")[0])),h=[].slice.call(l.getElementsByClassName("navigatePlayer")),this.addNavigateEvents()},o.prototype.changePrev=function(e){if(document.body.removeEventListener("onVideoEnded",S),document.body.removeEventListener("onMediaStop",S),document.body.removeEventListener("onMediaPlay",I),utils.removeClass(y,"slide active"),utils.addClass(y,"next"),y.innerHTML=e.videoNext,e.videoPrevious){var t=document.createElement("div");t.className="item previous",t.innerHTML=e.videoPrevious,u.insertBefore(t,g)}else{var t=document.createElement("div");t.className="item previous",u.insertBefore(t,g)}var i=document.createElement("div");i.className="item previous",u.insertBefore(i,t)},o.prototype.addMiniPlayerEvents=function(){if(isTouch){var t=new e.Manager(f);t.add(new e.Tap({event:"singletap"})),t.on("singletap",function(e){e.preventDefault(),this.closeMiniPlayer()}.bind(this))}else f.addEventListener("click",function(e){e.preventDefault(),this.closeMiniPlayer()}.bind(this));this.addEventScroll()},o.prototype.activateMini=function(e){w&&w.activateMini();var t=document.getElementById("pub_video")||!1;e?(p.style.height="",t&&(t.style.display="none",k=d.style.backgroundImage+"@@"+d.style.backgroundColor,d.style.backgroundImage="none",d.style.backgroundColor="")):p.style.height=p.offsetHeight+"px",t&&(t.style.display="none"),v.addEventListener("click",C),utils.removeClass(u,"addEffectFrame")},o.prototype.desactivateMini=function(){p.style.height="",utils.removeClass(d,"mini-player"),w&&w.desactivateMini();var e=document.getElementById("pub_video")||!1;if(e&&(e.style.display="block",k)){var t=k.split("@@");d.style.backgroundImage=t[0],d.style.backgroundColor=t[1],k=!1}l.removeEventListener("click",C),window.clearTimeout(b),b=window.setTimeout(function(){utils.addClass(u,"addEffectFrame")},100)},o.prototype.closeMiniPlayer=function(){utils.removeClass(d,"miniplayer"),utils.hasClass(d,"hasMiniNotVideo")?(p.innerHTML="",p.style.display="none",p.parentNode.removeChild(p),this.desactivateScroll()):(this.eventResize(),this.eventScroll())},o.prototype.desactivateScroll=function(){window.removeEventListener("scroll",E)},o.prototype.habillageMini=function(e){var t=e||!1;(utils.hasClass(d,"mini-player")||t)&&utils.ajax(reqConfig.envConfig.apiUrl+"miniplayers",{method:"GET",success:function(e){var t=e[0];if(t){var i=t.scheduling.publishAt,o=t.scheduling.expireAt,n=new Date;if(dateCheck(i,o,n)){var a=document.createElement("script"),r=document.getElementsByTagName("script")[0];a.src=reqConfig.envConfig.staticUrl+"assets/js/lib/ads_scripts/miniback.js",a.onload=function(){new miniBack({urlBackground:t.image.url,clickUrl:t.redirectionUrl}),
utils.addClass(d,"hasHabillage")},r.parentNode.insertBefore(a,r)}}},error:function(){}})},o.prototype.storeVideoId=function(e){var t=localStorage.getItem("reco_video_viewed");t=t?JSON.parse(t):[],t.length>50&&(t=t.slice(0,49)),t.unshift(e),localStorage.setItem("reco_video_viewed",JSON.stringify(t))},o.prototype.sendDMPReco=function(e){if(e.recoEngineConfig&&e.recoEngineConfig.recoEngine&&!reqConfig.envConfig.disableXitiAndDmp){var t=new Image,i=e.c_reco_compoliste,o="",n="",a="",r="";a=e.recoEngineConfig.userId,n=e.recoEngineConfig.ID||"",o=e.recoEngineConfig.recoEngine||"","cgk"===o&&(n="cognik"),r=e.recoEngineConfig.Rules;var s="desktop";this.windowWidth<767?s="smartphone":this.windowWidth<1024&&(s="tablet");var d=class_userlib.getOS().name.toLowerCase();__TMS.setReco({origin:"player",algorithmName:o,businessRule:r,displayedVideoIds:i,position:e.i,recoVideoId:_datapythagore.c_idvideo}),t.src="//pythagore.demdex.net/event?c_s_device="+encodeURIComponent(s)+"&c_s_os="+encodeURIComponent(d)+"&c_xtsite="+_datapythagore.c_xtsite+"&c_xt_atg="+(_datapythagore.c_xt_atg||null)+"&c_aam_uuid="+a+"&hashedId="+(_datapythagore.hashedId||null)+"&c_hashed_id="+(_datapythagore.c_hashed_id||null)+"&c_reco_idvideo="+_datapythagore.c_idvideo+"&c_reco_idliste="+n+"&c_reco_moteur="+o+"&c_reco_businessrule="+r+"&c_reco_positionvideo="+e.i+"&c_reco_action="+(e.c_reco_action?e.c_reco_action:"clic")+"&c_reco_compoliste="+i+"&c_reco_plusdevideo="+(e.c_reco_plusdevideo?e.c_reco_plusdevideo:"non")+"&c_reco_scroll="+(e.c_reco_visibilite?e.c_reco_visibilite:"non"),document.body.appendChild(t)}},o.prototype.sendDMP=function(e,t,i,o){var n=o||!1;if(n||(n="current"),void 0===this.hasSend[n]&&(this.hasSend[n]=[]),1!==this.hasSend[n][e]){this.hasSend[n][e]=1;var a=document.MYTF1&&document.MYTF1.c_reco_moteur_applique||"legacynl",r=document.MYTF1&&document.MYTF1.c_reco_moteur_attendu||"legacynl";if(class_userlib&&1==class_userlib.getCookie("dmpApplicable")&&1==class_userlib.getCookie("dmpApplicableConnectedUser")&&!reqConfig.envConfig.disableXitiAndDmp){var s=new Image;s.src="//pythagore.demdex.net/event?c_format="+i+"&c_emNumber="+(o||"")+"&c_frameReferer= "+encodeURIComponent(window.location.hostname)+"&c_videoDuration="+t+"&c_video_reached_duration="+e+"&c_idmove="+_datapythagore.c_idmove+"&c_idwat="+_datapythagore.c_idwat+"&c_idvideo="+_datapythagore.c_idvideo+"&c_programme_nom="+_datapythagore.c_programme_nom+"&c_moment_heure="+_datapythagore.c_moment_heure+"&c_moment_jourdate="+_datapythagore.c_moment_jourdate+"&c_moment_journomme="+_datapythagore.c_moment_journomme+"&hashedId="+(_datapythagore.hashedId||null)+"&c_hashed_id="+(_datapythagore.c_hashed_id||null)+"&c_xt_atg="+(_datapythagore.c_xt_atg||null)+"&c_facebook_id="+(_datapythagore.c_facebook_id||null)+"&c_reco_moteur_applique="+a+"&c_reco_moteur_attendu="+r,document.body.appendChild(s)}}},o});